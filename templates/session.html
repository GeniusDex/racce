{{$session := .}}
{{template "header.inc.html" .TrackName}}

<h2>Leader Board</h2>
{{template "sessionleaderboard.inc.html" .}}

<h2>Penalties</h2>
<table>
 <tr>
  <th>Car</th>
  <th>Driver</th>
  <th>Violation</th>
  <th>In lap</th>
  <th>Penalty</th>
  <th>Cleared in lap</th>
 </tr>
{{range .Penalties}}
    {{$car := carInSession .CarId $session}}
    {{$driver := index $car.Drivers .DriverIndex}}
 <tr>
  <td>{{$car.RaceNumber}}</td>
  <td><a href="../player/{{$driver.PlayerId}}">{{$driver.FirstName}} {{$driver.LastName}}</a></td>
  <td>{{.Reason}}</td>
  <td>{{.ViolationInLap}}</td>
  <td>{{.Penalty}}</td>
  <td>{{.ClearedInLap}}</td>
 </tr>
{{end}}
</table>

<h2>Laps per cars</h2>
{{$laps := .Laps}}
{{range .SessionResult.LeaderBoardLines}}
    {{$car := .Car}}
<h3>Car {{.Car.RaceNumber}} - {{range $index, $driver := .Car.Drivers}}{{if gt $index 0}}, {{end}}{{.FirstName}} {{.LastName}}{{end}}</h3>
<table>
 <tr>
  <th>Lap</th>
  <th>Driver</th>
  <th>Laptime</th>
  <th>Sector 1</th>
  <th>Sector 2</th>
  <th>Sector 3</th>
  <th>Valid</th>
 </tr>
    {{$lapnr := 0}}
    {{range $lap := $laps}}
        {{if eq .CarId $car.CarId}}
            {{$lapnr = add $lapnr 1}}
 <tr>
  <td>{{$lapnr}}</td>
  <td>{{(index $car.Drivers .DriverIndex).ShortName}}</td>
  <td>{{laptime .Laptime}}</td>
  <td>{{laptime (index .Splits 0)}}</td>
  <td>{{laptime (index .Splits 1)}}</td>
  <td>{{laptime (index .Splits 2)}}</td>
  <td>{{if .IsValidForBest}}true{{else}}false{{end}}</td>
 </tr>
        {{end}}
    {{end}}
</table>
{{end}}

{{template "footer.inc.html"}}
